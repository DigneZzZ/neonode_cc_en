---
title: Marzban 0.7.0
description: This guide provides basic information on installing Marzban according to the official repository.
tags:
  - Marzban
  - Marzban-Node
  - xray
  - proxy
series: MarzbanGuide
draft: false
pubDate: 11 03 2024
---

This guide is only applicable if you are installing Marzban for the first time.

# Changes in Marzban starting from version 0.7.0

The latest updates have been anticipated for several months.

These updates also include the latest security requirements for the panel and connections formulated by the Xray team.

<details>
  <summary>Detailed changes</summary>

🚀 Enhancements

-   **telegramBot:** Add onhold timeoute ([3c2bbed](https://github.com/Gozargah/Marzban/commit/3c2bbed23563f58aadae846e3ae2951ac24a0973))
-   Add address list support in hosts ([e80e119](https://github.com/Gozargah/Marzban/commit/e80e119ee8ce83e093927a1ac4b0cb241ef00112))
-   **subscription:** Add settings template for clash ([94a3f28](https://github.com/Gozargah/Marzban/commit/94a3f28198d317ae9f5f9cb8c7c4ade1da79f5ee))
-   **subscription:** Sync splithttp with 1.8.23 version ([d0c16a1](https://github.com/Gozargah/Marzban/commit/d0c16a1b2978bcd645b6605e84895e8e9c1e7b92))
-   SQLALCHEMY\_POOL\_SIZE and SQLIALCHEMY\_MAX\_OVERFLOW variables ([cea7f2f](https://github.com/Gozargah/Marzban/commit/cea7f2f70692f84b39a5c0eadf0edf766de6b020))
-   Variables to set jobs interval JOB\_CORE\_HEALTH\_CHECK\_INTERVAL JOB\_RECORD\_NODE\_USAGES\_INTERVAL JOB\_RECORD\_USER\_USAGES\_INTERVAL JOB\_REVIEW\_USERS\_INTERVAL JOB\_SEND\_NOTIFICATIONS\_INTERVAL ([2d50bf9](https://github.com/Gozargah/Marzban/commit/2d50bf94ff9baa27977cbf1e5e311d005eb99ee8))
-   Add node selection for logs in CoreSettingsModal.tsx ([b4dbba7](https://github.com/Gozargah/Marzban/commit/b4dbba7f75087ebb38cf46bf69c2377a219f1134))
-   Add duplicate host functionality in HostsDialog ([48b91c2](https://github.com/Gozargah/Marzban/commit/48b91c2aafb0197ed70c70623379c61c53101988))
-   Add up and down icons for reordering hosts ([1a3c0a0](https://github.com/Gozargah/Marzban/commit/1a3c0a040f4d719901d1ee216bb25a6450fb8db7))
-   Add Whitelist of IPs/hosts to disable login notifications ([b6d2658](https://github.com/Gozargah/Marzban/commit/b6d2658e56e075e841a6ca190c440bf8045327d5))
-   **api:** Adding the ability to calculate the consumption of admin users ([c2c98b7](https://github.com/Gozargah/Marzban/commit/c2c98b76b919d88353ab922753caaae72af0c214))
-   Add noise to hosts ([7d738cd](https://github.com/Gozargah/Marzban/commit/7d738cdd854eca1dda914a005f838c28604ef21e))
-   Add support for splithttp new variables ([2a7636a](https://github.com/Gozargah/Marzban/commit/2a7636a85bd13efd1fd17ca75a9cda7d5bdcd85c))
-   Add Transport RAW support ([8942abe](https://github.com/Gozargah/Marzban/commit/8942abee7a0a14460e798614f1524c4fd749261c))

 🩹 Fixes

-   Enforce SSL requirement for public access [XTLS/Xray-core#3884](https://github.com/XTLS/Xray-core/pull/3884) ([e60e54f](https://github.com/Gozargah/Marzban/commit/e60e54f55c6ea7f84f9f9c6024368d78935b790d))
-   **subscription:** Sending currect sorting for different v2rayng version ([5c5503d](https://github.com/Gozargah/Marzban/commit/5c5503d8b9dac538d8840ce4688ed89299530115))
-   Tgbot user protocol edit bug ([ef82864](https://github.com/Gozargah/Marzban/commit/ef828648f1f419c13362928358393669e02d3cb6))
-   Tgbot user reset usage error ([92fdeef](https://github.com/Gozargah/Marzban/commit/92fdeef7ff7be977b98159a9dac556bd4886c37f))
-   Add doc to db crud ([48a5ad2](https://github.com/Gozargah/Marzban/commit/48a5ad22717e6923d88b3b449c2813e6ae436eb5))
-   Tgbot links error when on\_hold is null ([d69fac6](https://github.com/Gozargah/Marzban/commit/d69fac63d793b325c0bf816ec07ab95412a71537))
-   **subscription:** Remove user-agent for sing-box and clash ([ff03e3a](https://github.com/Gozargah/Marzban/commit/ff03e3afce52f4953aaa7d971e0524903d0f1bfb))
-   Single str port for v2ray-json ([8f0c909](https://github.com/Gozargah/Marzban/commit/8f0c9095ea98ccd0d469a04974a9bc99d77d5d18))
-   Some minor fix of on\_hold status in telegram-bot ([cf98e95](https://github.com/Gozargah/Marzban/commit/cf98e95ccf69eff84fd5042747ff67021800fa56))
-   Catch error if settings template not found' ([582b2bb](https://github.com/Gozargah/Marzban/commit/582b2bba61b6461bb9d15e7fabede803e3539676))
-   **config:** Corrupting the hosts' data ([6483e42](https://github.com/Gozargah/Marzban/commit/6483e42df85ddc461e0eb9c8c4546a949f72e571))
-   Update user status doc ([3fb46c1](https://github.com/Gozargah/Marzban/commit/3fb46c1bbd4b12e6966829122389aedbd7bd7471))
-   Some frontend bugs ([2f2cbd1](https://github.com/Gozargah/Marzban/commit/2f2cbd1b3eb73d11f34de781c570701300e7afb8))
-   **subscription:** Separate http and none header settings ([e4bd603](https://github.com/Gozargah/Marzban/commit/e4bd603e135f4bb231f67ec2ce22473c6ffb0f94))
-   **subscription:** Separate http and h2 settings ([2260d28](https://github.com/Gozargah/Marzban/commit/2260d285b012beff45de500d3e3737b4504a3efb))
-   **subscription:** Multi mode for grpc ([a2ba2c0](https://github.com/Gozargah/Marzban/commit/a2ba2c009fb8f99ac3bfb8641763f200d6511c54))
-   **subscription:** Singbox ws ignore wsSettings ([c02ef96](https://github.com/Gozargah/Marzban/commit/c02ef96fe55def332c8fa14430fe8acb48ee368f))
-   **subscription:** Using wrong variable in settings ([70dfb6d](https://github.com/Gozargah/Marzban/commit/70dfb6d7e162952111f62675be673b4d4f6c3e83))
-   **subscription:** Prevent making noneSettings as a security setting ([87dca23](https://github.com/Gozargah/Marzban/commit/87dca230b611c0c86f00c9ec9b66bde77a2bf9b3))
-   False config as external config ([c63f95a](https://github.com/Gozargah/Marzban/commit/c63f95a7c2c2f34a16df679dd0593a5f94570e68))
-   **subscription:** Prevent making network\_setting for reality ([fb77570](https://github.com/Gozargah/Marzban/commit/fb7757077801e104203a1ec372b775eb6e5715ed))
-   **subscription:** Disable shuffle temporary to prevent sending wrong data ([e7d6756](https://github.com/Gozargah/Marzban/commit/e7d6756bb3e8d6e558769340326ae18356adae5d))
-   **splithttp:** Default value for splithttp ([aa664a2](https://github.com/Gozargah/Marzban/commit/aa664a28acdd2d3af8894c7a14d689ea69e9cc3e))
-   NOTIFY\_DAYS\_LEFT ([530649d](https://github.com/Gozargah/Marzban/commit/530649d6957b4f57fef10d19c82395a67c37f7ba))
-   Pydantic error on user.links ([25c07ac](https://github.com/Gozargah/Marzban/commit/25c07ac5a25c2b8deb167a2c0012954ba5066bdd))
-   Remove RANDOMIZE\_SUBSCRIPTION\_CONFIGS ([cb7aa7a](https://github.com/Gozargah/Marzban/commit/cb7aa7a8d5d6669f54ed44a56f2d4bc72b7ac28b))
-   **subscription:** Use deepcopy to avoid conflict ([f7d20b6](https://github.com/Gozargah/Marzban/commit/f7d20b672c242a3153af830baf5e6e40200eb582))
-   Marzban-cli compatible with python3.8 ([f3e6197](https://github.com/Gozargah/Marzban/commit/f3e6197454e70cf4db2dbd3ce8d3f61ec703d8a8))
-   Prevent error on login when request.client is None ([d77eb30](https://github.com/Gozargah/Marzban/commit/d77eb30cca48e6f01a9307596dc03522d3eb59ac))
-   **subscription:** Vless flow and tcp header fix ([7a0a9ca](https://github.com/Gozargah/Marzban/commit/7a0a9ca4f6d14672cf069d4df20576907595e783))
-   Subscription display in Hiddify in user\_subscription ([5169810](https://github.com/Gozargah/Marzban/commit/516981062612fea44736dd4460e1ab389d42956d))
-   Revoke subscription not updating xray config in telegram bot ([791a7f2](https://github.com/Gozargah/Marzban/commit/791a7f2f0845bc1b1a5b95f76b40832b86aef4f7))
-   Change outbound tag to proxy in v2ray custom config ([eb84a09](https://github.com/Gozargah/Marzban/commit/eb84a09da41ec9266080366d5cb6715bebde2400))
-   Prevent duplicated names in clash ([e37a3da](https://github.com/Gozargah/Marzban/commit/e37a3da5207df048f71970875fa126733f769241))
-   **subscription:** Vless flow and tcp header fix ([efc55ac](https://github.com/Gozargah/Marzban/commit/efc55ac3181a3f44c6e79d677b8c138f1d489566))
-   **subscription:** Tcp no tls empty header type ([241d823](https://github.com/Gozargah/Marzban/commit/241d823460059714077a718a45f4cd646f77ba32))
-   Some api bugs ([a10745d](https://github.com/Gozargah/Marzban/commit/a10745dfb1a119bdbbb0db0f76fa4d0bae2c5875))
-   Prevent passing unexpected variables to generate\_subscription ([f1395ee](https://github.com/Gozargah/Marzban/commit/f1395ee93253fbd7801ccb74119cc6afebbe3105))
-   Avoid creating dict with every request and remove external check ([47d8336](https://github.com/Gozargah/Marzban/commit/47d8336dc48a6336173152e84d65eb320585bd98))
-   Wrong spell for ALLOWED\_ORIGINS ([f0a7e21](https://github.com/Gozargah/Marzban/commit/f0a7e2187329c1689d31d34e95e59efc81f1d393))
-   Node\_user\_usages problem ([68dab4c](https://github.com/Gozargah/Marzban/commit/68dab4cd1092c9e452e8bcca151c40b8ec0f6bad))
-   Node\_usage error ([1332c7a](https://github.com/Gozargah/Marzban/commit/1332c7ab0b06d43054d986d8d28e5bc10eac5e80))
-   Shity refactor (using wrong admin for by field) ([d7281c2](https://github.com/Gozargah/Marzban/commit/d7281c2c84b47aa6e8fddea287f7001c9b1702da))
-   Refactor validate\_dates function (avoid writing duplicate code) ([aea3273](https://github.com/Gozargah/Marzban/commit/aea3273cd7c327d9870c435cb6a6c3d0741737d0))
-   Telegram bot not sending user limit result ([0ebbff3](https://github.com/Gozargah/Marzban/commit/0ebbff30520fb0d5cfbf45f5ca15031fe9cc6bb4))
-   **db:** Noise settings migration ([#1352](https://github.com/Gozargah/Marzban/pull/1352))
-   **hosts:** Check noise exist ([dcc9fd9](https://github.com/Gozargah/Marzban/commit/dcc9fd9e224a24c7b11e7047770d7799ab898136))
-   **subscription:** Remove network field for sing-box ([f9c15a1](https://github.com/Gozargah/Marzban/commit/f9c15a1e61309351fb8935fd8e34eaef51c3f265))
-   **Subscription:** Correctly build list of proxy remarks for clash config ([#1357](https://github.com/Gozargah/Marzban/pull/1357))
-   **config:** Http and allyes ([bc81290](https://github.com/Gozargah/Marzban/commit/bc81290e3e1454759cca8b38e2b52f35b2e1cba5))
-   Clash-meta unexpected keyword argument 'remark' ([9d49a11](https://github.com/Gozargah/Marzban/commit/9d49a11d2381dd72ee6ef199d3cf23e73f4b81f0))
-   **subscription:** H3 transport ([a930ed4](https://github.com/Gozargah/Marzban/commit/a930ed41260857cca7726170db70afaa55ad62aa))
-   Add DASHBOARD\_PATH as vites' base url in dev environment ([327e79a](https://github.com/Gozargah/Marzban/commit/327e79afaeadac6b04d6084cf03577273a8bf28a))
-   Circular import ([75bcdd9](https://github.com/Gozargah/Marzban/commit/75bcdd98825b4d44a206e78871a9d3cd81af0dfb))

 💅 Refactors

-   **api:** ⚠️ Added router to APIs ([cf6d8ac](https://github.com/Gozargah/Marzban/commit/cf6d8ac13c854f6b3e335fcc1a24ac57c0d5468a))
-   **admin-endpoints:** ⚠️ Refactor admin endpoints and add new two get admin depends ([e87e15b](https://github.com/Gozargah/Marzban/commit/e87e15bc28dc432c06ff9b52a1cd74c845ccbc74))
-   **node-endpoints:** ⚠️ Refactor node endpoints and add new two node depends ([cf4472b](https://github.com/Gozargah/Marzban/commit/cf4472b46fbf6d6985cdcc9f04e1ea10e3125901))
-   **system-endpoints:** ⚠️ Refactor system endpoints ([d631db5](https://github.com/Gozargah/Marzban/commit/d631db54e4f7aabdc58f545536025efb8a56f876))
-   **core-endpoints:** ⚠️ Refactor core endpoints ([ee341cb](https://github.com/Gozargah/Marzban/commit/ee341cb88003c92982bb8ef785d45af584bc6994))
-   **usertemplates-endpoints:** ⚠️ Refactor user templates endpoints ([6918f7f](https://github.com/Gozargah/Marzban/commit/6918f7fa09e460a123578266920113037637e3c2))
-   **home-endpoints:** ⚠️ Refactor home endpoints ([36532a9](https://github.com/Gozargah/Marzban/commit/36532a97916a8e7a7d046e162effb9c9aabf5432))
-   **sub-endpoints:** ⚠️ Refactor sub endpoints ([215bf32](https://github.com/Gozargah/Marzban/commit/215bf32d5974ff1b9c5eda62c29cc22fcc4ec33b))
-   **user:** ⚠️ Refactor user api and fix validate dates ([b551447](https://github.com/Gozargah/Marzban/commit/b5514472e82240edbd232830ba0c45b8fa253f12))
-   Merge moveUpHost and moveDownHost into moveHostPosition ([eb8bf54](https://github.com/Gozargah/Marzban/commit/eb8bf5444c06639f482467bc4df5d1e9fea37778))
-   **OnlineBadge:** Clean up code and optimize badge color logic ([603cf3d](https://github.com/Gozargah/Marzban/commit/603cf3d76cd8e337ac331a736054f1e96b8dbe8e))

 📖 Documentation

-   V2ray and sing-box template docs ([1f0d8dd](https://github.com/Gozargah/Marzban/commit/1f0d8dd30ab4eea962c5dba9934135f074d5a65c))
-   Add supported network for sing-box and v2ray ([4209ef4](https://github.com/Gozargah/Marzban/commit/4209ef477443b7909e27ccbbdb2662f3d46c2856))

 🏡 Chore

-   **subscription:** Use usion instead of dynamic type ([d19f567](https://github.com/Gozargah/Marzban/commit/d19f567b56d07cdf9d6c29453d9224dccbbcd922))
-   **subscription:** Customizeable config detail for v2ray- json and sing-box ([68a7936](https://github.com/Gozargah/Marzban/commit/68a79364fbc348ae5482c80709e2a2c1e94045e4))
-   **subscription:** Use fsring instead of if else ([9b6741a](https://github.com/Gozargah/Marzban/commit/9b6741af0bc7f3c9f9b99330efa8805e2f65a4c7))
-   **subscription:** Using deepcopy instead of copy ([d5822b7](https://github.com/Gozargah/Marzban/commit/d5822b7b710d5ae1325ed781ecd4e88859941106))
-   Fix env value ([a287147](https://github.com/Gozargah/Marzban/commit/a28714769ba6bd9fd6514a212641dfed25b29cd1))
-   Remove MASTER\_SERVER\_USAGE\_RATIO" ([8695b8c](https://github.com/Gozargah/Marzban/commit/8695b8c644c034a31a6cd2caaca5e3162d2d9fd7))
-   Remove Box Shadow CSS class, Change "Host" to "Master" in CoreSettingsModal.tsx ([eac8f06](https://github.com/Gozargah/Marzban/commit/eac8f062848e7c86b4954834c0b98ee165366e79))
-   Change login white list name ([ae5b6a6](https://github.com/Gozargah/Marzban/commit/ae5b6a68e4102cc8ebb6833f0b2e1677993aa34f))
-   Move home page route to routers module ([d87fee5](https://github.com/Gozargah/Marzban/commit/d87fee5ccc4c6c2cd94300f52ff83ea2d408368f))
-   **subscription:** Dialer outbound maker ([30201ba](https://github.com/Gozargah/Marzban/commit/30201ba5f606c6c40cfa05ca7603a173a0391b4a))

 ⚠️ Breaking Changes

-   **api:** ⚠️ Added router to APIs ([cf6d8ac](https://github.com/Gozargah/Marzban/commit/cf6d8ac13c854f6b3e335fcc1a24ac57c0d5468a))
-   **admin-endpoints:** ⚠️ Refactor admin endpoints and add new two get admin depends ([e87e15b](https://github.com/Gozargah/Marzban/commit/e87e15bc28dc432c06ff9b52a1cd74c845ccbc74))
-   **node-endpoints:** ⚠️ Refactor node endpoints and add new two node depends ([cf4472b](https://github.com/Gozargah/Marzban/commit/cf4472b46fbf6d6985cdcc9f04e1ea10e3125901))
-   **system-endpoints:** ⚠️ Refactor system endpoints ([d631db5](https://github.com/Gozargah/Marzban/commit/d631db54e4f7aabdc58f545536025efb8a56f876))
-   **core-endpoints:** ⚠️ Refactor core endpoints ([ee341cb](https://github.com/Gozargah/Marzban/commit/ee341cb88003c92982bb8ef785d45af584bc6994))
-   **usertemplates-endpoints:** ⚠️ Refactor user templates endpoints ([6918f7f](https://github.com/Gozargah/Marzban/commit/6918f7fa09e460a123578266920113037637e3c2))
-   **home-endpoints:** ⚠️ Refactor home endpoints ([36532a9](https://github.com/Gozargah/Marzban/commit/36532a97916a8e7a7d046e162effb9c9aabf5432))
-   **sub-endpoints:** ⚠️ Refactor sub endpoints ([215bf32](https://github.com/Gozargah/Marzban/commit/215bf32d5974ff1b9c5eda62c29cc22fcc4ec33b))
-   **user:** ⚠️ Refactor user api and fix validate dates ([b551447](https://github.com/Gozargah/Marzban/commit/b5514472e82240edbd232830ba0c45b8fa253f12))

More details here: **https://github.com/Gozargah/Marzban/releases/tag/v0.7.0**

</details>

# My Philosophy for Choosing a Rental Server

## Philosophy

If your Marzban server is already generating or planning to generate significant income, you need to ensure a sufficient level of reliability for your infrastructure.
1. Don’t skimp on high-quality and reliable servers.
2. Don’t skimp on resources for good load handling.
3. Don’t skimp on the cost of your nodes – connection stability and quality are essential for the growth of your "business"/"project."
4. Ideally, get main servers from major providers focused on corporate clients. Examples: Selectel, Cloud.Vk.Com, Yandex Cloud, Cloud.ru, etc.
You may also consider providers like AWS, Vultr, Kamatera, Hetzner, but again – choose plans with dedicated cores, not shared, and ensure 100% guarantee that your server won’t be deleted and you can always pay for it.
5. Situations with sites can vary widely, from DDoS attacks to client influx. But, of course, don’t forget about economics.
6. The better the provider and channels, the happier your clients will be. Don’t strive to offer 30 countries to choose from – your clients won’t appreciate it. Base your choice on your client’s geography. For Russia, a server in Europe is ideal. Very rarely will anyone need a location in the US… let alone somewhere like Chile or Australia.

> Thus, the provider should be stable, and ideally foreign.

I have already shared my recommendations in the VPS Insider channel (though, due to lack of interest, I stopped updating it, leaving the full history there) – you can join via the link for 170 TG Stars: https://t.me/+lQBQTGym57hmOTAy

- Speed should be 10Gbps – at least 2-5Gbps. 
- Traffic from 3-5TB (total). Of course, unlimited is better, but quality servers usually have limited traffic. The final choice will depend on your total traffic.

> Having a 10Gbps server but with 1 core and 1GB of memory – you will never get maximum speed. Already with a stable load of 1Gbps, your 1 core will run at 100%, and you’ll

 lose traffic, speed, and clients.

## Renting a Server

Get a server here: [https://procloud.ru?referral_id=274473](https://procloud.ru?referral_id=274473)

- Location: Moscow (or any other of your choice)
- OS: Ubuntu 24.04
- CPU: 2 cores
- Memory: 4GB
- Disk: 30GB

# Installation

At the time of writing, my PR for installation scripts is under review: [Marzban PR](https://github.com/Gozargah/Marzban-scripts/pull/29)

Installation script:

```bash
sudo bash -c "$(curl -sL https://github.com/DigneZzZ/Marzban-scripts-beta/raw/main/marzban.sh)" @ install --database mariadb
```

You will end up with Marzban installed but without a domain.

## Create admin 

```bash
sudo marzban cli admin create --sudo
```

## Domain Binding in CloudFlare

Once you have chosen and purchased a domain, you need to host it somewhere and bind it to the server.

CloudFlare is the best option for this.

## Certificate Issuance

For these tasks, Acme.sh is an excellent solution.

Generate it on your server for your domain:

```bash
~/.acme.sh/acme.sh --set-default-ca --server letsencrypt --issue --standalone \
-d DOMAIN \
--key-file /var/lib/marzban/certs/key.pem \
--fullchain-file /var/lib/marzban/certs/fullchain.pem
```

Replace **DOMAIN** with your purchased and bound domain to your server.

## Adjust the .env File

### Open the .env file with the command:

```bash
marzban edit-env
```

### Change the port to 443
```bash
UVICORN_PORT = 443
```

### Add records to the obtained certificates

```shell
UVICORN_SSL_CERTFILE = "/var/lib/marzban/certs/fullchain.pem"
UVICORN_SSL_KEYFILE = "/var/lib/marzban/certs/key.pem"
```

That’s basically it.

Now, all that remains is to add the configuration to Xray and start using it.

## Extended Guide and Detailed Descriptions

### The full version of my article with all detailed instructions, settings, and installation options (including how to hide behind a Reverse Proxy) is available in the Marzban club on the forum: https://openode.xyz

#### To gain access, you must first purchase a subscription: https://openode.xyz/subscriptions/

#### You can find announcements of my articles here: https://openode.xyz/forum/90-marzban/