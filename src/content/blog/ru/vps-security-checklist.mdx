---
title: "–ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ VPS –Ω–∞ Ubuntu –∏ Debian: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç–∫–∞"
description: "–≠—Ç–æ—Ç –≥–∏–¥ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã VPS –Ω–∞ Ubuntu –∏–ª–∏ Debian: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–∫–ª—é—á–µ–π, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫, —Å–º–µ–Ω–∞ –ø–æ—Ä—Ç–∞ SSH –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ UFW. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è VPN-—Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —É–≥—Ä–æ–∑."
tags:
   - VPS
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
   - SSH
   - Fail2ban
   - UFW
   - Ubuntu
   - Debian
   - –ö–ª—é—á–∏ SSH
   - –ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
series: SecurityGuide
draft: false
pubDate: 11 05 2024
---

# –ü–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ VPS –Ω–∞ Ubuntu –∏ Debian: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç–∫–∞

–≠—Ç–∞ –ø–∞–º—è—Ç–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —à–∞–≥–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –±–∞–∑–µ Ubuntu –∏–ª–∏ Debian. –î–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è VPS, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã VPN.

## üõ°Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî –Ω–µ –≥–ª–∞–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞. –ì–ª–∞–≤–Ω–æ–µ ‚Äî —ç—Ç–æ –∑–¥—Ä–∞–≤—ã–π —Å–º—ã—Å–ª –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –í–æ—Ç –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

-  **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ–Ω–ª–∞–π–Ω —Ö—Ä–∞–Ω–∏–ª–∏—â–∞—Ö –ø–∞—Ä–æ–ª–µ–π** (–º–Ω–æ–≥–æ —Å–ª—É—á–∞–µ–≤ —Å–ª–∏–≤–æ–≤ –ø–∞—Ä–æ–ª–µ–π) –∏–ª–∏ –≤ TXT —Ñ–∞–π–ª–µ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ. –õ—É—á—à–µ –≤—Å–µ–≥–æ —Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å —Ç–æ–ª—å–∫–æ –≤ —Å–≤–æ–µ–π –≥–æ–ª–æ–≤–µ –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –µ–≥–æ, –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ –∑–∞–≤–µ–¥–∏—Ç–µ –±—É–º–∞–∂–Ω—ã–π –±–ª–æ–∫–Ω–æ—Ç. –¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –ø–∞—Ä–æ–ª–µ–π —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º [KeePassXC](https://keepassxc.org/) –∏–ª–∏ [Bitwarden](https://bitwarden.com/), —Ç–∞–∫–æ–π —Å–ø–æ—Å–æ–± —Ç–æ–∂–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–µ–∑–æ–ø–∞—Å–µ–Ω. –ï—Å–ª–∏ –∂–µ –≤—ã —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –º–µ–Ω—è—Ç—å —Å–≤–æ–∏ –ø—Ä–∏–≤—ã—á–∫–∏, —Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –º–∞—Å—Ç–µ—Ä –ø–∞—Ä–æ–ª–µ–º.
-  **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** —Å —É—á—ë—Ç–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤.
-  **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É—Å–∏–ª—å—Ç–µ –∑–∞—â–∏—Ç—É Email** –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º.
-  **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è Email** –∏ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞. –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Å–º—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é, –∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã 2FA —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ —Ç–∏–ø—É [Aegis](https://f-droid.org/ru/packages/com.beemdevelopment.aegis/), 2FA, –Ø–Ω–¥–µ–∫—Å –∫–ª—é—á –∏ —Ç.–¥., —Ç–∞–∫ –∫–∞–∫ —Å–º—Å –º–æ–≥—É—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–ª–æ–Ω–∞ –≤–∞—à–µ–π —Å–∏–º –∫–∞—Ä—Ç—ã (—Ä–µ–¥–∫–∏–π —Å–ª—É—á–∞–π, –Ω–æ —Ç–∞–∫ –±—ã–≤–∞–µ—Ç). –Ø –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑—É—é [Aegis](https://f-droid.org/ru/packages/com.beemdevelopment.aegis/)
-  **–ù–µ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ FTP-–∫–ª–∏–µ–Ω—Ç–∞—Ö** ‚Äî –æ—á–µ–Ω—å —á–∞—Å—Ç–æ –≤–∏—Ä—É—Å—ã –±–µ—Ä—É—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ FTP-–∫–ª–∏–µ–Ω—Ç–∞.
-  **–ù–∏–∫–æ–º—É –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Å–Ω–æ–≤–Ω–æ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**, –∏ –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –ø–µ—Ä–µ–¥–∞—á–µ –¥–æ—Å—Ç—É–ø–∞, —Å–æ–∑–¥–∞–π—Ç–µ –¥–ª—è —ç—Ç–æ–≥–æ –Ω–æ–≤—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏. –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ—Ç–æ–º —É–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å.

## üîê –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SSH-–∫–ª—é—á–∞: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SSH-–∫–ª—é—á–µ–π ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Å–µ—Ä–≤–µ—Ä—É. –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ SSH-–∫–ª—é—á–µ–π –ø–µ—Ä–µ–¥ –ø–∞—Ä–æ–ª–µ–º ‚Äî —ç—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –ø–æ —Å–µ—Ç–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –±–æ–ª–µ–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º.

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH-–∫–ª—é—á–µ–π

–ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ –∫–ª—é—á—É, –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞: **—Å–µ–∫—Ä–µ—Ç–Ω—ã–π (private)** –∏ **–ø—É–±–ª–∏—á–Ω—ã–π (public)** –∫–ª—é—á–∏. –í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å:

1. –í–≤–µ–¥–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä—ã –∫–ª—é—á–µ–π RSA:

   ```bash
   ssh-keygen -t rsa -b 2048
   ```

2. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—Ä–æ—Å–∏—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–≤–µ—Å—Ç–∏ **—Å–µ–∫—Ä–µ—Ç–Ω—É—é —Ñ—Ä–∞–∑—É (passphrase)** –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã. –≠—Ç–æ—Ç –ø–∞—Ä–æ–ª—å –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º, –Ω–æ –ª—É—á—à–µ –≤–≤–µ—Å—Ç–∏ —Å–ª–æ–∂–Ω—É—é —Ñ—Ä–∞–∑—É –¥–ª—è –±–æ–ª—å—à–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–∞–∂–º–∏—Ç–µ **Enter** ‚Äî –∫–ª—é—á–∏ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `~/.ssh`.

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `~/.ssh`, –≥–¥–µ –æ–Ω–∏ –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:

```bash
cd ~/.ssh
```

–í —ç—Ç–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –¥–≤–∞ —Ñ–∞–π–ª–∞:

- **id_rsa** ‚Äî —ç—Ç–æ –≤–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –¥—Ä—É–≥–∏–º.
- **id_rsa.pub** ‚Äî —ç—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

### –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–ß—Ç–æ–±—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ SSH-–∫–ª—é—á—É, –ø–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –û–¥–∏–Ω –∏–∑ —É–¥–æ–±–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ SFTP, —Ç–∞–∫–∏–µ –∫–∞–∫ [Filezilla](https://filezilla-project.org/), –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã SFTP.

–ü–æ—Å–ª–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª **authorized_keys** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, —á—Ç–æ–±—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `id_rsa.pub` –≤ —Ñ–∞–π–ª `authorized_keys`, –¥–æ–±–∞–≤–∏–≤ –µ–≥–æ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞:

   ```bash
   cat id_rsa.pub >> ~/.ssh/authorized_keys
   ```

   –≠—Ç–æ—Ç —Ñ–∞–π–ª `authorized_keys` –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `~/.ssh` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OpenSSH –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –∫–ª—é—á—É

–¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é OpenSSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ –∫–ª—é—á—É:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OpenSSH:

   ```bash
   nano /etc/ssh/sshd_config
   ```

2. –ù–∞–π–¥–∏—Ç–µ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ –∫–ª—é—á—É –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

   ```bash
   PubkeyAuthentication yes  
   AuthorizedKeysFile %h/.ssh/authorized_keys  
   RhostsRSAAuthentication no  
   HostbasedAuthentication no  
   PermitEmptyPasswords no
   ```

3. –ß—Ç–æ–±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ –ø–∞—Ä–æ–ª—é, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `PasswordAuthentication` –≤ `no`. –≠—Ç–æ —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `sshd_config`:

   ```bash
   PasswordAuthentication no
   ```

   > **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í Ubuntu 24.04 —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ `/etc/ssh/sshd_config.d/50-cloud-init.conf`. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∞–º, –µ—Å–ª–∏ –ø—Ä–∞–≤–∫–∞ `sshd_config` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è Ubuntu 24.04 –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RSA:

   ```bash
   PubkeyAcceptedAlgorithms +ssh-rsa
   ```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Ñ–∞–π–ª—ã –∫–ª—é—á–µ–π

–û–±–µ—Å–ø–µ—á—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º –∏ —Ñ–∞–π–ª–∞–º SSH, —á—Ç–æ–±—ã —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –∏—Ö —á–∏—Ç–∞—Ç—å:

```bash
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ SSH-—Å–µ—Ä–≤–µ—Ä–∞

–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä:

```bash
systemctl restart ssh
```

–¢–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –∫–ª—é—á—É –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í—ã –º–æ–∂–µ—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –±–µ–∑ –ø–∞—Ä–æ–ª—è, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ –≤–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á.

# üö´ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Fail2ban

–î–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–æ–ª—è –ø–æ SSH –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Fail2ban. –ü–æ—Å–ª–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è, Fail2ban –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP –∞–¥—Ä–µ—Å —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—ã—Ç–∞–ª–∏—Å—å –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–∞—Ä–æ–ª—å. –ß–∏—Å–ª–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –Ω–∞ —á–∞—Å –ø–æ—Å–ª–µ –ø—è—Ç–∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è –≤ SSH.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Fail2ban –≤ Ubuntu

```bash
apt update -y && apt upgrade -y
apt-get install fail2ban
```

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±—ã Fail2ban –≤–≤–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏, —Ç.–∫. fail2ban –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):

```bash
systemctl enable fail2ban
systemctl start fail2ban
```
–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–ª—É–∂–±—ã Fail2ban:

```bash
systemctl status fail2ban
```

## –û—Å–Ω–æ–≤—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Fail2ban: –†–∞–∑–±–∏—Ä–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

Fail2ban ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—â–∏—â–∞–µ—Ç –≤–∞—à —Å–µ—Ä–≤–µ—Ä –æ—Ç –∞—Ç–∞–∫ –ø—É—Ç–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ —Å–æ–≤–µ—Ä—à–∞—é—Ç –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã SSH, FTP, HTTP –∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Fail2ban —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞ Linux.

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Fail2ban

–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã Fail2ban –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/etc/fail2ban`. –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ‚Äî `jail.conf`. –û–¥–Ω–∞–∫–æ –µ–≥–æ **–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑–º–µ–Ω—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é**: –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Fail2ban —ç—Ç–æ—Ç —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω, –∏ –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.

–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –≤ `/etc/fail2ban/jail.d`. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –ø—Ä–∏ —ç—Ç–æ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏. –≠—Ç–∏ —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–µ–∫—Ü–∏–∏, –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ *—Ç—é—Ä—å–º–∞–º–∏* –∏–ª–∏ *–∏–∑–æ–ª—è—Ç–æ—Ä–∞–º–∏* (jails), ‚Äî –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞—â–∏—Ç—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä SSH, HTTP –∏–ª–∏ FTP.

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã –¥–ª—è SSH:

```ini
[sshd]
enabled = true
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Fail2ban

–ü—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Fail2ban –≤–∞–∂–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–ª—è—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ:

- **`ignoreip`** ‚Äî —Å–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è Fail2ban, –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π IP-–∞–¥—Ä–µ—Å, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —É–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–µ—Ç—å –∏–ª–∏ DNS-–∏–º—è.
  
  ```ini
  ignoreip = 192.168.1.1 10.0.0.0/24 mytrustedhost.com
  ```

- **`bantime`** ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP-–∞–¥—Ä–µ—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —ç—Ç–æ –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ—Ç, –∞–¥—Ä–µ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö.

  ```ini
  bantime = 3600  # –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 1 —á–∞—Å
  ```

- **`maxretry`** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π. –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å –∏–ª–∏ —Å–æ–≤–µ—Ä—à–∏—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –ø—Ä–µ–∂–¥–µ —á–µ–º IP –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.

  ```ini
  maxretry = 3
  ```

- **`port`** ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞ –∫–∞–∫–æ–º –ø–æ—Ä—Ç—É –∏–ª–∏ –ø–æ—Ä—Ç–∞—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—â–∞–µ–º—ã–π —Å–µ—Ä–≤–∏—Å. –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ä—Ç–æ–≤.

  ```ini
  port = ssh
  ```

- **`filter`** ‚Äî –∏–º—è —Ñ–∏–ª—å—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π Fail2ban –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä –∏—â–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –≤ –ª–æ–≥-—Ñ–∞–π–ª–∞—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è SSH –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä `sshd`, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ `/etc/fail2ban/filter.d/sshd.conf`.

  ```ini
  filter = sshd
  ```

- **`logpath`** ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∂—É—Ä–Ω–∞–ª–∞, –≥–¥–µ Fail2ban –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è. –û–±—ã—á–Ω–æ –¥–ª—è SSH —ç—Ç–æ `/var/log/auth.log`.

  ```ini
  logpath = /var/log/auth.log
  ```

- **`action`** ‚Äî –¥–µ–π—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –∫–æ–≥–¥–∞ Fail2ban –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫—Ä–∏—Ç–µ—Ä–∏—è–º –ø–æ–∏—Å–∫–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É IP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º iptables.

  ```ini
  action = %(action_)s
  ```

### –ü–æ—Ä—è–¥–æ–∫ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Fail2ban

Fail2ban —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –§–∞–π–ª—ã `.local` –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ `.conf`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö. –ü–æ—Ä—è–¥–æ–∫ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:

1. `/etc/fail2ban/jail.conf` ‚Äî –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∑–∞–¥–∞–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
2. `/etc/fail2ban/jail.d/*.conf` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.
3. `/etc/fail2ban/jail.local` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
4. `/etc/fail2ban/jail.d/*.local` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Fail2ban

–ü–æ–º–∏–º–æ `jail.conf`, Fail2ban –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- `action.d/*.*` ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
- `fail2ban.conf` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.
- `fail2ban.d/*.*` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Fail2ban.
- `filter.d/*.*` ‚Äî —à–∞–±–ª–æ–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤ –ª–æ–≥–∞—Ö.
- `paths-arch.conf`, `paths-common.conf`, `paths-debian.conf`, `paths-opensuse.conf` ‚Äî —Ñ–∞–π–ª—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

–ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ —Ñ–∞–π–ª—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –º–æ–∂–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞—â–∏—Ç—É –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è —Ä–∏—Å–∫ –≤–∑–ª–æ–º–∞ –∏ –ø–æ–≤—ã—Å–∏–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Fail2ban –¥–ª—è SSH

> –ò—Å—Ç–æ—á–Ω–∏–∫: https://homehosted.ru/ustanovka-i-nastrojka-fail2ban

SSH –∏–∑–æ–ª—è—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Fail2Ban –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–∞. –ù–æ –µ—Å–ª–∏ –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –µ–≥–æ —Ä–∞–±–æ—Ç—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π jail —Ñ–∞–π–ª. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä nano:

``nano /etc/fail2ban/jail.d/ssh.conf``

–î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```ini
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
findtime = 300
backend = systemd
```

`sshd` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–∞–≤–∏–ª–∞;
`enabled` –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –≤–∫–ª—é—á–∞—Ç—å (true) –∏–ª–∏ –æ—Ç–∫–ª—é—á–∞—Ç—å (false) –ø—Ä–∞–≤–∏–ª–æ;
`port` ‚Äî –ø–æ—Ä—Ç —Ü–µ–ª–µ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –±—É–∫–≤–µ–Ω–Ω–æ–µ –∏–ª–∏ —Ü–∏—Ñ–∏—Ä–Ω–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ;
`filter` ‚Äî —Ñ–∏–ª—å—Ç—Ä (–∫—Ä–∏—Ç–µ—Ä–∏–π –ø–æ–∏—Å–∫–∞), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –ü–æ —Å—É—Ç–∏, —ç—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ /etc/fail2ban/filter.d –±–µ–∑ .conf –Ω–∞ –∫–æ–Ω—Ü–µ;
`logpath` ‚Äî —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ñ–∏–ª—å—Ç—Ä –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤.
`maxretry` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ —Å–æ–≤–µ—Ä—à–∏—Ç—å –¥–æ –±–∞–Ω–∞.
`findtime` ‚Äî –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è maxretry;
–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å:

```bash
systemctl restart fail2ban
```
–£–∫–∞–∑–∞–Ω–Ω–∞—è –Ω–∞–º–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP –∞–¥—Ä–µ—Å–∞ –ø–æ—Å–ª–µ 3-—Ö –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ª–æ–≥–∏–Ω–∞ –Ω–∞ –í–∞—à —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ SSH. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç 300 —Å–µ–∫—É–Ω–¥, –∞ –≤—Å–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª–∞ /var/log/auth.log.

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –í–∞—à–∏ –Ω—É–∂–¥—ã.

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –¥–ª—è SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ Ubuntu –∏ Debian

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é SSH-—Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ **TCP-–ø–æ—Ä—Ç 22**. –≠—Ç–æ—Ç –ø–æ—Ä—Ç —Ö–æ—Ä–æ—à–æ –∏–∑–≤–µ—Å—Ç–µ–Ω, –ø–æ—ç—Ç–æ–º—É –º–Ω–æ–≥–∏–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ –∞—Ç–∞–∫—É—é—Ç –µ–≥–æ, –ø—ã—Ç–∞—è—Å—å –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–∞—Ä–æ–ª–∏ (bruteforce). –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –¥–ª—è SSH —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —Ç–∞–∫–∏—Ö –∞—Ç–∞–∫, –¥–µ–ª–∞—è –≤–∞—à —Å–µ—Ä–≤–µ—Ä –º–µ–Ω–µ–µ –∑–∞–º–µ—Ç–Ω—ã–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∫–∞–Ω–µ—Ä–æ–≤.

### –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å SSH-–ø–æ—Ä—Ç

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É.** –û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è SSH-–∫–ª–∏–µ–Ω—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, PuTTY (–Ω–∞ Windows) –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ SSH-–∫–æ–º–∞–Ω–¥—ã (–Ω–∞ macOS –∏ Linux).

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ net-tools**. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —É—Ç–∏–ª–∏—Ç—ã `net-tools`, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏—Ö —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:

   ```bash
   sudo apt install net-tools
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤.** –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ –ø–æ—Ä—Ç—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –Ω–µ –∑–∞–Ω—è—Ç—ã–π –ø–æ—Ä—Ç –¥–ª—è SSH:

   ```bash
   sudo netstat -tupln | grep LISTEN
   ```

   –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ –∏ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –≤—ã–±—Ä–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç.

4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ SSH.** –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `sshd_config`, –≤ –∫–æ—Ç–æ—Ä–æ–º —É–∫–∞–∑–∞–Ω –ø–æ—Ä—Ç –¥–ª—è SSH:

   ```bash
   sudo nano /etc/ssh/sshd_config
   ```

5. **–ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ—Ä—Ç–æ–º.** –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É, –≥–¥–µ —É–∫–∞–∑–∞–Ω–æ `#Port 22`. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ—ë, —É–¥–∞–ª–∏–≤ —Å–∏–º–≤–æ–ª `#`, –∏ –∑–∞–º–µ–Ω–∏—Ç–µ `22` –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞–º–∏ –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç `2222` –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç:

   ```bash
   Port 2222
   ```

6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.** –ü–æ—Å–ª–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª, –Ω–∞–∂–∞–≤ `CTRL + O`, –∑–∞—Ç–µ–º –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–∂–∞—Ç–∏–µ–º **Enter** –∏ –≤—ã–π–¥–∏—Ç–µ –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞, –Ω–∞–∂–∞–≤ `CTRL + X`.

7. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞.** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–æ–≤—ã–π SSH-–ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç –≤ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–µ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UFW):

   ```bash
   sudo ufw allow 2222/tcp
   ```

8. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ SSH –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä, —á—Ç–æ–±—ã –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É:

   ```bash
   sudo service ssh restart
   ```

–¢–µ–ø–µ—Ä—å SSH-—Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç—É.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Ubuntu 24.04

–í Ubuntu 24.04 –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ SSH —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —à–∞–≥–∞. –í —ç—Ç–æ–º –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤–Ω–µ—Å—ë–Ω–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª `sshd_config`. –ü–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç —Ç–∞–∫–∂–µ –≤ —Ñ–∞–π–ª–µ `50-cloud-init.conf`:

1. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ 50-cloud-init.conf.** –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

   ```bash
   sudo nano /etc/ssh/sshd_config.d/50-cloud-init.conf
   ```

2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞.** –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `#Port 22`, —Ä–∞—Å—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ—ë –∏ —É–∫–∞–∂–∏—Ç–µ —Ç–æ—Ç –∂–µ –Ω–æ–≤—ã–π –ø–æ—Ä—Ç, —á—Ç–æ –∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ–∞–π–ª–µ:

   ```plaintext
   Port 2222
   ```

3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫.** –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª (CTRL + O –∏ Enter) –∏ –≤—ã–π–¥–∏—Ç–µ (CTRL + X). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–Ω–æ–≤–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Ä–≤–µ—Ä:

   ```bash
   sudo systemctl restart ssh
   ```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ –Ω–æ–≤—ã–π –ø–æ—Ä—Ç

–¢–µ–ø–µ—Ä—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–æ—Ä—Ç —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–∞ `-p`:

```bash
ssh -p 2222 username@server_ip
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Ä—Ç –∏ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É.

### –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:

–î–ª—è –≤—Å–µ—Ö –∫—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–ª –¥–æ —ç—Ç–æ–≥–æ –ø—É–Ω–∫—Ç–∞, **–±–æ–Ω—É—Å**.

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å–º–µ–Ω—ã –ø–æ—Ä—Ç–∞ SSH:

```bash
bash <(wget -qO- https://dignezzz.github.io/server/ssh-port.sh)
```
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π –ø–æ—Ä—Ç, –∏ —Å–∫—Ä–∏–ø—Ç —Å–∞–º –≤—Å–µ –ø–æ–º–µ–Ω—è–µ—Ç. –ò –¥–∞–∂–µ –¥–æ–±–∞–≤–∏—Ç –≤ UFW/iptables —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å.

# üî• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ UFW –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **Uncomplicated Firewall (UFW)** ‚Äî —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞—â–∏—Ç—É —Å–µ—Ä–≤–µ—Ä–∞. UFW ‚Äî —ç—Ç–æ –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–¥ `iptables`, –∫–æ—Ç–æ—Ä–∞—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW**. –ù–∞—á–Ω–µ–º —Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ UFW, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:

   ```bash
   sudo apt install ufw
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**. –°–Ω–∞—á–∞–ª–∞ –∑–∞–¥–∞–π—Ç–µ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é UFW –±—É–¥–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –≤—Å–µ –∏—Å—Ö–æ–¥—è—â–∏–µ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–Ω–µ—à–Ω–µ–º—É –º–∏—Ä—É, –Ω–æ –≤–Ω–µ—à–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã.

   ```bash
   sudo ufw default deny incoming
   sudo ufw default allow outgoing
   ```

   –≠—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –ø–æ–º–æ–≥—É—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø, –æ—Å—Ç–∞–≤–∏–≤ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–æ–ª—å–∫–æ —Ç–µ –ø–æ—Ä—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –æ—Ç–∫—Ä–æ–µ—Ç–µ —Å–∞–º–∏.

## –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

–ü–æ—Å–∫–æ–ª—å–∫—É SSH ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ –ø–æ—Ä—Ç—É SSH, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É, —É–∫–∞–∑–∞–≤ –≤–º–µ—Å—Ç–æ `PORT` –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ SSH, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ `22`):

   ```bash
   sudo ufw allow PORT
   ```

   > **–ü—Ä–∏–º–µ—Ä**: –ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ SSH-–ø–æ—Ä—Ç –Ω–∞ `2222`, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sudo ufw allow 2222`.

   –ü–æ–º–∏–º–æ –ø–æ—Ä—Ç–∞ SSH, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥—Ä—É–≥–∏–º –≤–∞–∂–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º, —Ç–∞–∫–∏–º –∫–∞–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã (–ø–æ—Ä—Ç—ã `80` –¥–ª—è HTTP –∏ `443` –¥–ª—è HTTPS):

   ```bash
   sudo ufw allow 80
   sudo ufw allow 443
   ```

## –ê–∫—Ç–∏–≤–∞—Ü–∏—è UFW

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª –≤–∫–ª—é—á–∏—Ç–µ UFW, —á—Ç–æ–±—ã –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –Ω–∞—á–∞–ª –∑–∞—â–∏—â–∞—Ç—å —Å–µ—Ä–≤–µ—Ä. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

   ```bash
   sudo ufw enable
   ```

   –ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ UFW –æ—Ç–æ–±—Ä–∞–∑–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —á—Ç–æ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –≤–∫–ª—é—á–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.

## –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Fail2ban

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **Fail2ban** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫, –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è UFW —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Fail2ban, —á—Ç–æ–±—ã –æ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–ª —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞:

   ```bash
   sudo systemctl restart fail2ban
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–∞–≤–∏–ª UFW –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

   ```bash
   sudo ufw status verbose
   ```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª, –∞ —Ç–∞–∫–∂–µ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞.

> **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ**: –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ UFW –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ [DigitalOcean](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-with-ufw-on-ubuntu-22-04).

–¢–µ–ø–µ—Ä—å UFW –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∞–∫—Ç–∏–≤–µ–Ω, –±–ª–æ–∫–∏—Ä—É—è –≤—Å–µ –Ω–µ–Ω—É–∂–Ω—ã–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –æ—Ç–∫—Ä—ã–≤–∞—è —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã.

# üìå –í—ã–≤–æ–¥

–°–ª–µ–¥—É—è —ç—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º, –≤—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ VPS. –≠—Ç–∏ —à–∞–≥–∏ –∑–∞—â–∏—Ç—è—Ç —Å–µ—Ä–≤–µ—Ä –æ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∞—Ç–∞–∫ –∏ –ø–æ–º–æ–≥—É—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ.
